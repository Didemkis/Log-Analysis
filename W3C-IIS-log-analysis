W3C ISS LOG ANALİZ

IIS Günlükleri, bir web sunucusunda gerçekleşen etkinliklere dair ayrıntılı bilgileri içeren bir veri kümesidir. W3C günlük dosyası formatı, NCSA dosya formatına kıyasla daha fazla veri depolayabilen, ASCII tabanlı, virgülle ayrılmış bir formattır. Bu format, çeşitli alanları yakalayarak istekler arasındaki farkları belirlemede kullanılır.

W3C günlük dosyasındaki her giriş, günlük aracının istekleri birbirinden ayırt etmesine olanak tanıyan benzersiz bir tanımlayıcı içerir. Bu tanımlayıcı, istek satırı ve gövde metni gibi isteğin farklı bölümlerini ayırmak için de kullanılabilir.

Günlük dosyasının önemli alanları şunlardır:
- Tarih ve Saat: İsteğin ne zaman yapıldığını gösterir.
- cs-ip: Web sunucusuna erişen istemcinin IP adresi.
- cs-kullanıcı adı: İsteği yapan kullanıcının adı.
- cs-uri-stem: İstemcinin talep ettiği URI.

Örneğin, bir istemci statik bir dosyada saklanan bir web sayfasına erişim istediğinde, cs-uri-stem alanı istemci tarafından talep edilen dosyanın ne olduğunu belirtir. Bu alanlar, sunucu günlüklerinde kötü amaçlı kodların veya diğer anormalliklerin tespit edilmesinde çok değerlidir.

Ayrıca, cs-uri-stem alanı kullanıcının hangi tarayıcıyı kullandığını belirtirken, cs-kullanıcı adı alanı web sunucusuna kimlik doğrulaması yapan kişinin bilgilerini sağlar. Bu bilgiler, sunucu güvenliğini izlemek ve olası tehditleri tespit etmek için kritik öneme sahiptir.

Example
Örnek log formatı:

#Version: 1.0
#Date: 12-Jan-1996 00:00:00
#Fields: time cs-method cs-uri
00:34:23 GET /foo/bar.html

Çeşitli logları analiz yapalım : 

#Fields: date time s-ip cs-method cs-uri-stem cs-uri-query s-port cs-username c-ip cs(User-Agent) cs(Referer) sc-status sc-substatus sc-win32-status time-taken

#Software: Microsoft Internet Information Services 10.0
#Version: 1.0
#Date: 2024-08-01 15:45:00
#Fields: date time s-ip cs-method cs-uri-stem cs-uri-query s-port cs-username c-ip cs(User-Agent) cs(Referer) sc-status sc-substatus sc-win32-status time-taken
2024-08-01 15:45:00 fe80::abcd:1234:efgh:5678%1 RPC_IN_DATA /rpc/rpcproxy.dll 2e5038fc-7891-45cd-93fe-gh90j21k030h@test.com:7001&CorrelationID=<empty>;&RequestId=22e7b89b-8d45-5g54-9511-be34d215bb73&cafeReqId=22e7b89b-8d45-5g54-9511-be34d215bb73; 443 TEST\HealthMailbox1234567 fe80::abcd:1234:efgh:5678%1 MSRPC - 503 1 1 9123


ANALİZ: 
Ortak Bilgiler

    Yazılım: Microsoft Internet Information Services 10.0
    Sürüm: 1.0
    Tarih: 2024-08-01
    Alanlar:
        date: 01.08.2024
        time: 15:45:00
        s-ip: Sunucu IP adresi
        cs-method: RPC_IN_DATA
        cs-uri-stem: /rpc/rpcproxy.dll
        cs-uri-query: 2e5038fc-7891-45cd-93fe-gh90j21k030h@test.com:7001&CorrelationID=<empty>;&RequestId=22e7b89b-8d45-5g54-9511-be34d215bb73&cafeReqId=22e7b89b-8d45-5g54-9511-be34d215bb73;
        s-port: 443
        cs-username: TEST\HealthMailbox1234567
        c-ip: fe80::abcd:1234:efgh:5678%1
        cs(User-Agent): MSRPC
        cs(Referer): -
        sc-status: 503
       
